<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>test</title>
  </head>
  <body>
    <header th:insert="fragments/page_header::pageHeader"></header>
    <main>
      <div class="container">
        <div class="register-box">
          <h2 class="register-text">
            <a th:href="@{/index/register}" id="register-link">資産登録</a>
          </h2>
        </div>
        <form th:action="@{/index/searchAsset}" th:object="${searchForm}" method="POST" name="searchForm" id="searchForm">
          <!-- 資産ID検索窓 -->
          <label for="id">資産ID</label>
          <input type="text" name="id" id="id" th:value="${id}"/>
          <!-- カテゴリ選択窓 -->
          <label for="categoryId">資産種別</label>
          <select name="categoryId" id="categoryId">
            <option value="">資産種別を選んで下さい</option>
            <option
              th:each="category:${categoryList}"
              th:selected="${selected == category.categoryId}"
              th:value="${category.categoryId}"
              th:text="${category.categoryName}"
            ></option>
          </select>
          <!-- 管理者名検索窓 -->
          <label for="adminName">管理者</label>
          <input type="text" name="adminName" id="adminName" th:value="${adminName}"/>
          <!-- 検索ワード窓 -->
          <label for="assetName">資産名</label>
          <input type="text" name="assetName" id="assetName" th:value="${assetName}"/>
          <button id="searchBtn" type="submit">検索</button>
        </form>
        <form id="csvform" method="post" th:action="@{/download/csv}">
          <input type="hidden" name="filename" />
          <button type="submit">CSV</button>
        </form>

        <!-- 検索エラーメッセージ表示 -->
        <h1 class="errorMsg" th:text="${assetIdErrorMsg}" th:if="${assetPage == null}"></h1>

        <!-- 資産リスト表示 -->
        <table class="top" th:if="${assetPage != null && assetPage.getSize() != 0}">
          <caption> All asset list </caption>
          <thead>
            <tr>
              <th id="id_cell">資産ID</th>
              <th id="categoryName_cell">資産種別</th>
              <th id="adminName_cell">管理者名</th>
              <th id="assetName_cell">資産名</th>
              <th id="remarks_cell">備考</th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="asset:${assetPage}">
              <td class="assetIdColumn">
                <!-- ↓AssetControllerへ飛ぶ -->
                <a
                  th:href="@{/index/assetDetail/{id}(id=${asset.id})}"
                  th:text="${#numbers.formatInteger(asset.id,4)}"
                ></a>
              </td>
              <td class="categoryName" th:text="${asset.categoryId}"></td>
              <td class="adminName" th:text="${asset.adminName}"></td>
              <td class="assetName" th:text="${asset.assetName}"></td>
              <td class="remarks" th:text="${asset.remarks}"></td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- ページング -->
      <th:block th:if="${assetPage.totalPages > 0}">
        <nav aria-label="Page navigation">
        <ul class="pagination">
          <li class="page-item">
            <a th:href="@{/index/}" class="page-link" aria-label="Previous">
              <span aria-hidden="true">&lt;&lt;</span>
            </a>
          </li>
          <li class="page-item" th:if="${assetPage.getNumber() > 1}">
            <a th:href="@{/index/{page} (page = ${assetPage.getNumber()})}" class="page-link" aria-label="Previous">
              <span aria-hidden="true">&lt;</span>
            </a>
          </li>
          <li class="page-item" th:with="start = 1, end = ${lastPage}" th:each="pageNumber : ${pageNumbers}">
            <a class="page-link" th:href="@{/index/{page} (page = ${pageNumber})}" th:text="${pageNumber}"></a>
          </li>
          <li class="page-item" th:if="${assetPage.totalPages > assetPage.getNumber() + 1 }">
            <a th:href="@{/index/{page} (page = ${assetPage.getNumber() + 2})}" class="page-link" aria-label="Next">
              <span aria-hidden="true">&gt;</span>
            </a>
          </li>
          <li class="page-item">
            <a th:href="@{/index/{page} (page = ${lastPage})}" class="page-link" aria-label="Next">
              <span aria-hidden="true">&gt;&gt;</span>
            </a>
          </li>
        </ul>
        </nav>
      </th:block>
    </main>
  </body>
</html>
